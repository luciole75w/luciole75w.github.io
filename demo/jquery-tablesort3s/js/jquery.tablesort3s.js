// jquery-tablesort3s v1.1.0 | https://github.com/luciole75w/jquery-tablesort3s | MPL 2.0 licensed
"use strict";!function(o){o.fn.extend({tablesort3s:function(e,s){return this.filter("table").each(function(){let t=o(this).data("tablesort3s");void 0===t&&(t=new i(this,"object"==typeof e?e:{}),o(this).data("tablesort3s",t)),"number"!=typeof e&&!1!==e||t.sort(e,s)})}});class r{constructor(t,e){this.$row=o(t),this.$initialSection=this.$row.parent(),this.$sortedSection=this.$initialSection.parent().children("tbody").first(),this.fake=void 0!==e?this.$row.is(e):this.$row.children().is(function(){return 1<this.colSpan}),this.rank=t.rowIndex,this.fake?this.fakeKey={text:"#"+this.rank,num:this.rank}:this.keys=this.parse()}updateDOM(t){this.fake&&t?this.$row.detach():this.$row.appendTo(t?this.$sortedSection:this.$initialSection)}parse(){return o.map(this.$row.prop("cells"),function(t){var t=o(t).text().toLowerCase(),e=/^[+-]?\d+(?:\.\d+)?/.exec(t);return{text:t,num:null!==e?Number(e[0]):null}})}static comparator(a,o){return!1===a?function(t,e){return t.rank-e.rank}:function(t,e){var s=t.fake?t.fakeKey:t.keys[a],r=e.fake?e.fakeKey:e.keys[a];let i;if(s.num!==r.num)i=null!==s.num?null!==r.num?s.num-r.num:1:-1;else if(s.text<r.text)i=-1;else{if(!(s.text>r.text))return t.rank-e.rank;i=1}return o?i:-i}}}class i{static defaultHints=["+","-","x","x"];static getColumnHeaders(t){var e=Array.prototype.reduce.call(t.rows[0].cells,(t,e)=>t+e.colSpan,0),s=new Array(e).fill(0),r=new Array(e);for(const a of t.rows){let t=0;for(const o of a.cells){for(;s[t]>a.rowIndex;)++t;1===o.colSpan&&"TH"===o.tagName&&(r[t]=o);for(var i=t+o.colSpan;t<i;++t)s[t]+=o.rowSpan}}return r}constructor(t,e){this.headerCells=i.getColumnHeaders(t.tHead),this.widgetCells=void 0!==e.widgetsRow?o(t.tHead.rows).filter(e.widgetsRow).prop("cells"):this.headerCells,this.source=Array.prototype.flatMap.call(t.tBodies,t=>Array.prototype.map.call(t.rows,t=>new r(t,e.fakeFilter)));const s=Object.assign([],i.defaultHints,e.hints);this.hinter=function(){var t=2*o(this).hasClass("sort-on")+!o(this).hasClass("sort-asc");return s[t]},(1<this.source.length||e.forceUI)&&this.bindWidgets(this,e.noSortFilter,e.widgetClass)}bindWidgets(r,i,a){o(this.headerCells).each(function(t,e){var s;void 0===this||o(e).is(i??".nosort")||((s=o('<div role="group">').addClass(a??"sort").append(o('<button class="sort-asc">')).append(o('<button class="sort-desc">'))).children().on("click",function(){r.sort(!o(this).hasClass("sort-on")&&t,o(this).hasClass("sort-asc"))}).data("tablesort3s-header",e).attr({type:"button",title:r.hinter}).text(function(){return this.title}),s.appendTo(r.widgetCells[t]))})}sort(t,e){o(".sort-on",this.widgetCells).removeClass("sort-on").attr("title",this.hinter).text(function(){return this.title}).map((t,e)=>o(e).data("tablesort3s-header")).attr("aria-sort",null),!1!==t&&o(e?".sort-asc":".sort-desc",this.widgetCells[t]).addClass("sort-on").attr("title",this.hinter).text(function(){return this.title}).map((t,e)=>o(e).data("tablesort3s-header")).attr("aria-sort",e?"ascending":"descending"),this.source.sort(r.comparator(t,e)),o.each(this.source,function(){this.updateDOM(!1!==t)})}}}(jQuery);
